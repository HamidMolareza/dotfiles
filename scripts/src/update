#!/bin/bash

set -euo pipefail

# Define color codes
GREEN='\033[1;32m'
YELLOW='\033[1;33m'
NC='\033[0m' # No Color

# Helper to print steps with color
function step() {
    echo -e "${YELLOW}👉 $1${NC}"
}

# Helper to print success message
function success() {
    echo -e "${GREEN}✅ $1${NC}"
}

# Helper to print info message
function info() {
    echo -e "${GREEN}ℹ️ $1${NC}"
}

step "Updating APT package lists..."
sudo apt update

step "Upgrading installed APT packages..."
sudo apt upgrade -y

step "Performing APT distribution upgrade..."
sudo apt dist-upgrade -y

step "Cleaning up unnecessary APT packages..."
sudo apt autoremove -y
sudo apt autoclean -y

step "Refreshing Snap packages..."
sudo snap refresh

# Update Flatpak if installed
if command -v flatpak &>/dev/null; then
    step "Updating Flatpak packages..."
    flatpak update -y

    step "Removing unused Flatpak runtimes..."
    flatpak uninstall --unused -y
else
    info "Flatpak is not installed. Skipping Flatpak updates."
fi

success "System update complete!"
